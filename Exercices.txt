Задание 6.
Для каждого производителя, выпускающего ПК-блокноты c объёмом жесткого диска не менее 10 Гбайт, найти скорости таких ПК-блокнотов. Вывод: производитель, скорость.
Решение:
SELECT DISTINCT PRODUCT.MAKER, LAPTOP.speed
from PRODUCT JOIN LAPTOP ON PRODUCT.MODEL=LAPTOP.MODEL 
where LAPTOP.hd >=10

Задание 7.
Найдите номера моделей и цены всех имеющихся в продаже продуктов (любого типа) производителя B (латинская буква).
Решение:
SELECT a.model, price 
FROM (SELECT model, price 
FROM PC 
UNION 
SELECT model, price 
FROM Laptop 
UNION 
SELECT model, price 
FROM Printer) AS a JOIN 
Product p ON a.model = p.model 
WHERE p.maker = 'B'

Задание 8.
Найдите производителя, выпускающего ПК, но не ПК-блокноты.
Решение:
select distinct product.maker
from product
where type='pc'
except
select distinct product.maker
from product
where type='laptop'

Задание 9.
Найдите производителей ПК с процессором не менее 450 Мгц. Вывести: Maker
Решение:
SELECT DISTINCT product.maker
FROM Product JOIN PC ON product.model = pc.model
WHERE speed >= 450

Задание 10.
Найдите модели принтеров, имеющих самую высокую цену. Вывести: model, price
Решение:
SELECT model, price
FROM printer
WHERE price = (SELECT MAX(price) FROM printer)

Задание 11.
Найдите среднюю скорость ПК.
Решение:
SELECT AVG(speed) AS average_speed
FROM pc

Задание 12.
Найдите среднюю скорость ПК-блокнотов, цена которых превышает 1000 дол.
Решение:
SELECT AVG(speed) AS average_speed
FROM laptop
WHERE price > 1000

Задание 13.
Найдите среднюю скорость ПК, выпущенных производителем A.
Решение:
SELECT AVG (pc.speed) AS avg_speed
FROM pc
JOIN product ON pc.model = product.model
WHERE product.maker = 'A'

Задание 14.
Найдите класс, имя и страну для кораблей из таблицы Ships, имеющих не менее 10 орудий.
Решение:
SELECT Ships.class, Ships.name, Classes.country
FROM Ships
JOIN Classes ON Ships.class = Classes.class
WHERE Classes.numGuns >= 10

Задание 15.
Найдите размеры жестких дисков, совпадающих у двух и более PC. Вывести: HD
Решение:
SELECT pc.hd
FROM pc
GROUP BY pc.hd
HAVING COUNT(pc.hd) >= 2

Задание 16.
Найдите пары моделей PC, имеющих одинаковые скорость и RAM. В результате каждая пара указывается только один раз, т.е. (i,j), но не (j,i), Порядок вывода: модель с большим номером, модель с меньшим номером, скорость и RAM.
Решение:
SELECT DISTINCT
    pc_1.model,
    pc_2.model,
    pc_1.speed,
    pc_1.ram
FROM pc pc_1, pc pc_2
WHERE pc_1.speed = pc_2.speed
    AND pc_1.ram = pc_2.ram 
    AND pc_1.model > pc_2.model

Задание 17.
Найдите модели ПК-блокнотов, скорость которых меньше скорости каждого из ПК.
Вывести: type, model, speed
Решение:
SELECT DISTINCT type, laptop.model, speed
FROM laptop 
JOIN product ON product.model = laptop.model
WHERE speed < ALL (SELECT speed FROM pc)

Задание 18.
Найдите производителей самых дешевых цветных принтеров. Вывести: maker, price
Решение:
SELECT maker, price
FROM printer 
JOIN product ON product.model = printer.model
WHERE price = (
      SELECT MIN(price) price 
      FROM printer
      WHERE color = 'y')
AND color = 'y'
GROUP BY maker, price

Задание 19.
Для каждого производителя, имеющего модели в таблице Laptop, найдите средний размер экрана выпускаемых им ПК-блокнотов.
Вывести: maker, средний размер экрана.
Решение:
SELECT maker, AVG(screen) avg_screen
FROM laptop 
JOIN product ON product.model = laptop.model
GROUP BY maker

Задание 20.
Найдите производителей, выпускающих по меньшей мере три различных модели ПК. Вывести: Maker, число моделей ПК.
Решение:
SELECT maker, COUNT (model) model
FROM Product
WHERE type = 'pc' group by maker
HAVING COUNT(model)>=3

Задание 21.
Найдите максимальную цену ПК, выпускаемых каждым производителем, у которого есть модели в таблице PC.
Вывести: maker, максимальная цена.
Решение:
SELECT maker, MAX(price) max_price
FROM pc
JOIN product ON product.model = pc.model
GROUP BY maker

Задание 22.
Для каждого значения скорости ПК, превышающего 600 МГц, определите среднюю цену ПК с такой же скоростью. Вывести: speed, средняя цена.
Решение:
SELECT speed, AVG(price) avg_price 
FROM pc
WHERE speed > 600
GROUP BY speed

Задание 23.
Найдите производителей, которые производили бы как ПК
со скоростью не менее 750 МГц, так и ПК-блокноты со скоростью не менее 750 МГц.
Вывести: Maker
Решение:
SELECT maker 
FROM pc
JOIN product ON product.model = pc.model
WHERE speed >=750
INTERSECT
SELECT maker 
FROM laptop
JOIN product ON product.model = laptop.model
WHERE speed >=750

Задание 24.
Перечислите номера моделей любых типов, имеющих самую высокую цену по всей имеющейся в базе данных продукции.
Решение:
SELECT model FROM (
SELECT model, price FROM pc
UNION
SELECT model, price FROM laptop
UNION
SELECT model, price FROM printer) test1 WHERE PRICE = (
SELECT MAX(price) FROM(
SELECT model, price FROM pc
UNION
SELECT model, price FROM laptop
UNION
SELECT model, price FROM printer
) test2
)

Задание 25.
Найдите производителей принтеров, которые производят ПК с наименьшим объемом RAM и с самым быстрым процессором среди всех ПК, имеющих наименьший объем RAM. Вывести: Maker
Решение:
SELECT DISTINCT maker FROM pc 
JOIN product on product.model = pc.model
WHERE maker IN
(SELECT DISTINCT maker FROM product
WHERE type = 'printer')
AND speed = (SELECT MAX(speed) FROM pc
WHERE ram = (SELECT MIN(ram) FROM pc))
AND ram = (SELECT MIN(ram) from pc)

